
# explorer tweaks
write-host "Configuring Explorer"
$key = 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
Set-ItemProperty $key Hidden 1
Set-ItemProperty $key HideFileExt 0
Set-ItemProperty $key ShowSuperHidden 1

# hide Cortana
Set-ItemProperty 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Search' SearchboxTaskbarMode 0

# re-enable network type selection dialog
reg delete "HKLM\System\CurrentControlSet\Control\Network\NewNetworkWindowOff" /F

# confirm delete
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "ConfirmFileDelete" /t REG_DWORD /d "1" /f

# Defender Exclusions
write-host "Configuring Defender"
Set-MpPreference -ExclusionPath "c:\pentest"

write-host "Finished"